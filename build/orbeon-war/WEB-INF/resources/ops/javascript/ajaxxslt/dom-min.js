function xmlResolveEntities(j){var b=stringSplit(j,"&");var f=b[0];for(var c=1;c<b.length;++c){var d=b[c].indexOf(";");if(d==-1){f+=b[c];continue}var g=b[c].substring(0,d);var e=b[c].substring(d+1);var a;switch(g){case"lt":a="<";break;case"gt":a=">";break;case"amp":a="&";break;case"quot":a='"';break;case"apos":a="'";break;case"nbsp":a=String.fromCharCode(160);break;default:var h=domCreateElement(window.document,"span");h.innerHTML="&"+g+"; ";a=h.childNodes[0].nodeValue.charAt(0)}f+=a+e}return f}var XML10_TAGNAME_REGEXP=new RegExp("^("+XML10_NAME+")");var XML10_ATTRIBUTE_REGEXP=new RegExp(XML10_ATTRIBUTE,"g");var XML11_TAGNAME_REGEXP=new RegExp("^("+XML11_NAME+")");var XML11_ATTRIBUTE_REGEXP=new RegExp(XML11_ATTRIBUTE,"g");function xmlParse(c){var j=/\/$/;var s;var h;if(c.match(/^<\?xml/)){if(c.search(new RegExp(XML10_VERSION_INFO))==5){s=XML10_TAGNAME_REGEXP;h=XML10_ATTRIBUTE_REGEXP}else{if(c.search(new RegExp(XML11_VERSION_INFO))==5){s=XML11_TAGNAME_REGEXP;h=XML11_ATTRIBUTE_REGEXP}else{alert("VersionInfo is missing, or unknown version number.")}}}else{s=XML10_TAGNAME_REGEXP;h=XML10_ATTRIBUTE_REGEXP}var a=new XDocument();var q=a;var g=[];var l=q;g.push(l);var b="";var m=stringSplit(c,"<");for(var r=1;r<m.length;++r){var f=stringSplit(m[r],">");var w=f[0];var n=xmlResolveEntities(f[1]||"");if(b){var d=m[r].indexOf(b);if(d!=-1){var u=m[r].substring(0,d);l.nodeValue+="<"+u;g.pop();l=g[g.length-1];n=m[r].substring(d+b.length);b=""}else{l.nodeValue+="<"+m[r];n=null}}else{if(w.indexOf("![CDATA[")==0){var e="![CDATA[".length;var d=m[r].indexOf("]]>");if(d!=-1){var u=m[r].substring(e,d);var p=domCreateCDATASection(a,u);domAppendChild(l,p)}else{var u=m[r].substring(e);n=null;var p=domCreateCDATASection(a,u);domAppendChild(l,p);l=p;g.push(p);b="]]>"}}else{if(w.indexOf("!--")==0){var e="!--".length;var d=m[r].indexOf("-->");if(d!=-1){var u=m[r].substring(e,d);var p=domCreateComment(a,u);domAppendChild(l,p)}else{var u=m[r].substring(e);n=null;var p=domCreateComment(a,u);domAppendChild(l,p);l=p;g.push(p);b="-->"}}else{if(w.charAt(0)=="/"){g.pop();l=g[g.length-1]}else{if(w.charAt(0)=="?"){}else{if(w.charAt(0)=="!"){}else{var k=w.match(j);var t=s.exec(w)[1];var p=domCreateElement(a,t);var o;while(o=h.exec(w)){var v=xmlResolveEntities(o[5]||o[7]||"");domSetAttribute(p,o[1],v)}domAppendChild(l,p);if(!k){l=p;g.push(p)}}}}}}}if(n&&l!=q){domAppendChild(l,domCreateTextNode(a,n))}}return q}var DOM_ELEMENT_NODE=1;var DOM_ATTRIBUTE_NODE=2;var DOM_TEXT_NODE=3;var DOM_CDATA_SECTION_NODE=4;var DOM_ENTITY_REFERENCE_NODE=5;var DOM_ENTITY_NODE=6;var DOM_PROCESSING_INSTRUCTION_NODE=7;var DOM_COMMENT_NODE=8;var DOM_DOCUMENT_NODE=9;var DOM_DOCUMENT_TYPE_NODE=10;var DOM_DOCUMENT_FRAGMENT_NODE=11;var DOM_NOTATION_NODE=12;function domTraverseElements(b,d,e){var a;if(d){a=d.call(null,b);if(typeof a=="boolean"&&!a){return false}}for(var f=b.firstChild;f;f=f.nextSibling){if(f.nodeType==DOM_ELEMENT_NODE){a=arguments.callee.call(this,f,d,e);if(typeof a=="boolean"&&!a){return false}}}if(e){a=e.call(null,b);if(typeof a=="boolean"&&!a){return false}}}function XNode(c,b,a,d){this.attributes=[];this.childNodes=[];XNode.init.call(this,c,b,a,d)}XNode.init=function(c,b,d,a){this.nodeType=c-0;this.nodeName=""+b;this.nodeValue=""+d;this.ownerDocument=a;this.firstChild=null;this.lastChild=null;this.nextSibling=null;this.previousSibling=null;this.parentNode=null};XNode.unused_=[];XNode.recycle=function(d){if(!d){return}if(d.constructor==XDocument){XNode.recycle(d.documentElement);return}if(d.constructor!=this){return}XNode.unused_.push(d);for(var b=0;b<d.attributes.length;++b){XNode.recycle(d.attributes[b])}for(var e=0;e<d.childNodes.length;++e){XNode.recycle(d.childNodes[e])}d.attributes.length=0;d.childNodes.length=0;XNode.init.call(d,0,"","",null)};XNode.create=function(c,b,e,a){if(XNode.unused_.length>0){var d=XNode.unused_.pop();XNode.init.call(d,c,b,e,a);return d}else{return new XNode(c,b,e,a)}};XNode.prototype.appendChild=function(a){if(this.childNodes.length==0){this.firstChild=a}a.previousSibling=this.lastChild;a.nextSibling=null;if(this.lastChild){this.lastChild.nextSibling=a}a.parentNode=this;this.lastChild=a;this.childNodes.push(a)};XNode.prototype.replaceChild=function(b,d){if(d==b){return}for(var a=0;a<this.childNodes.length;++a){if(this.childNodes[a]==d){this.childNodes[a]=b;var c=d.parentNode;d.parentNode=null;b.parentNode=c;c=d.previousSibling;d.previousSibling=null;b.previousSibling=c;if(b.previousSibling){b.previousSibling.nextSibling=b}c=d.nextSibling;d.nextSibling=null;b.nextSibling=c;if(b.nextSibling){b.nextSibling.previousSibling=b}if(this.firstChild==d){this.firstChild=b}if(this.lastChild==d){this.lastChild=b}break}}};XNode.prototype.insertBefore=function(b,d){if(d==b){return}if(d.parentNode!=this){return}if(b.parentNode){b.parentNode.removeChild(b)}var f=[];for(var a=0;a<this.childNodes.length;++a){var e=this.childNodes[a];if(e==d){f.push(b);b.parentNode=this;b.previousSibling=d.previousSibling;d.previousSibling=b;if(b.previousSibling){b.previousSibling.nextSibling=b}b.nextSibling=d;if(this.firstChild==d){this.firstChild=b}}f.push(e)}this.childNodes=f};XNode.prototype.removeChild=function(b){var e=[];for(var a=0;a<this.childNodes.length;++a){var d=this.childNodes[a];if(d!=b){e.push(d)}else{if(d.previousSibling){d.previousSibling.nextSibling=d.nextSibling}if(d.nextSibling){d.nextSibling.previousSibling=d.previousSibling}if(this.firstChild==d){this.firstChild=d.nextSibling}if(this.lastChild==d){this.lastChild=d.previousSibling}}}this.childNodes=e};XNode.prototype.hasAttributes=function(){return this.attributes.length>0};XNode.prototype.setAttribute=function(a,c){for(var b=0;b<this.attributes.length;++b){if(this.attributes[b].nodeName==a){this.attributes[b].nodeValue=""+c;return}}this.attributes.push(XNode.create(DOM_ATTRIBUTE_NODE,a,c,this))};XNode.prototype.getAttribute=function(a){for(var b=0;b<this.attributes.length;++b){if(this.attributes[b].nodeName==a){return this.attributes[b].nodeValue}}return null};XNode.prototype.removeAttribute=function(c){var b=[];for(var d=0;d<this.attributes.length;++d){if(this.attributes[d].nodeName!=c){b.push(this.attributes[d])}}this.attributes=b};XNode.prototype.getElementsByTagName=function(c){var b=[];var a=this;if("*"==c){domTraverseElements(this,function(d){if(a==d){return}b.push(d)},null)}else{domTraverseElements(this,function(d){if(a==d){return}if(d.nodeName==c){b.push(d)}},null)}return b};XNode.prototype.getElementById=function(b){var a=null;domTraverseElements(this,function(c){if(c.getAttribute("id")==b){a=c;return false}},null);return a};function XDocument(){XNode.call(this,DOM_DOCUMENT_NODE,"#document",null,null);this.documentElement=null}XDocument.prototype=new XNode(DOM_DOCUMENT_NODE,"#document");XDocument.prototype.clear=function(){XNode.recycle(this.documentElement);this.documentElement=null};XDocument.prototype.appendChild=function(a){XNode.prototype.appendChild.call(this,a);this.documentElement=this.childNodes[0]};XDocument.prototype.createElement=function(a){return XNode.create(DOM_ELEMENT_NODE,a,null,this)};XDocument.prototype.createDocumentFragment=function(){return XNode.create(DOM_DOCUMENT_FRAGMENT_NODE,"#document-fragment",null,this)};XDocument.prototype.createTextNode=function(a){return XNode.create(DOM_TEXT_NODE,"#text",a,this)};XDocument.prototype.createAttribute=function(a){return XNode.create(DOM_ATTRIBUTE_NODE,a,null,this)};XDocument.prototype.createComment=function(a){return XNode.create(DOM_COMMENT_NODE,"#comment",a,this)};XDocument.prototype.createCDATASection=function(a){return XNode.create(DOM_CDATA_SECTION_NODE,"#cdata-section",a,this)};